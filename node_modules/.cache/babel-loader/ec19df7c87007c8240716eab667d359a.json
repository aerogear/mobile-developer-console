{"ast":null,"code":"'use strict';\n/**\n * Copyright Marc J. Schmidt. See the LICENSE file at the top-level\n * directory of this distribution and at\n * https://github.com/marcj/css-element-queries/blob/master/LICENSE.\n */\n\n(function (root, factory) {\n  if (typeof define === \"function\" && define.amd) {\n    define(factory);\n  } else if (typeof exports === \"object\") {\n    module.exports = factory();\n  } else {\n    root.ResizeSensor = factory();\n  }\n})(typeof window !== 'undefined' ? window : this, function () {\n  // Make sure it does not throw in a SSR (Server Side Rendering) situation\n  if (typeof window === \"undefined\") {\n    return null;\n  } // Only used for the dirty checking, so the event callback count is limited to max 1 call per fps per sensor.\n  // In combination with the event based resize sensor this saves cpu time, because the sensor is too fast and\n  // would generate too many unnecessary events.\n\n\n  var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || function (fn) {\n    return window.setTimeout(fn, 20);\n  };\n  /**\n   * Iterate over each of the provided element(s).\n   *\n   * @param {HTMLElement|HTMLElement[]} elements\n   * @param {Function}                  callback\n   */\n\n\n  function forEachElement(elements, callback) {\n    var elementsType = Object.prototype.toString.call(elements);\n    var isCollectionTyped = '[object Array]' === elementsType || '[object NodeList]' === elementsType || '[object HTMLCollection]' === elementsType || '[object Object]' === elementsType || 'undefined' !== typeof jQuery && elements instanceof jQuery //jquery\n    || 'undefined' !== typeof Elements && elements instanceof Elements //mootools\n    ;\n    var i = 0,\n        j = elements.length;\n\n    if (isCollectionTyped) {\n      for (; i < j; i++) {\n        callback(elements[i]);\n      }\n    } else {\n      callback(elements);\n    }\n  }\n  /**\n  * Get element size\n  * @param {HTMLElement} element\n  * @returns {Object} {width, height}\n  */\n\n\n  function getElementSize(element) {\n    if (!element.getBoundingClientRect) {\n      return {\n        width: element.offsetWidth,\n        height: element.offsetHeight\n      };\n    }\n\n    var rect = element.getBoundingClientRect();\n    return {\n      width: Math.round(rect.width),\n      height: Math.round(rect.height)\n    };\n  }\n  /**\n   * Class for dimension change detection.\n   *\n   * @param {Element|Element[]|Elements|jQuery} element\n   * @param {Function} callback\n   *\n   * @constructor\n   */\n\n\n  var ResizeSensor = function ResizeSensor(element, callback) {\n    /**\n     *\n     * @constructor\n     */\n    function EventQueue() {\n      var q = [];\n\n      this.add = function (ev) {\n        q.push(ev);\n      };\n\n      var i, j;\n\n      this.call = function (sizeInfo) {\n        for (i = 0, j = q.length; i < j; i++) {\n          q[i].call(this, sizeInfo);\n        }\n      };\n\n      this.remove = function (ev) {\n        var newQueue = [];\n\n        for (i = 0, j = q.length; i < j; i++) {\n          if (q[i] !== ev) newQueue.push(q[i]);\n        }\n\n        q = newQueue;\n      };\n\n      this.length = function () {\n        return q.length;\n      };\n    }\n    /**\n     *\n     * @param {HTMLElement} element\n     * @param {Function}    resized\n     */\n\n\n    function attachResizeEvent(element, resized) {\n      if (!element) return;\n\n      if (element.resizedAttached) {\n        element.resizedAttached.add(resized);\n        return;\n      }\n\n      element.resizedAttached = new EventQueue();\n      element.resizedAttached.add(resized);\n      element.resizeSensor = document.createElement('div');\n      element.resizeSensor.dir = 'ltr';\n      element.resizeSensor.className = 'resize-sensor';\n      var style = 'pointer-events: none; position: absolute; left: 0px; top: 0px; right: 0; bottom: 0; ' + 'overflow: hidden; z-index: -1; visibility: hidden; max-width: 100%;';\n      var styleChild = 'position: absolute; left: 0; top: 0; transition: 0s;';\n      element.resizeSensor.style.cssText = style;\n      element.resizeSensor.innerHTML = '<div class=\"resize-sensor-expand\" style=\"' + style + '\">' + '<div style=\"' + styleChild + '\"></div>' + '</div>' + '<div class=\"resize-sensor-shrink\" style=\"' + style + '\">' + '<div style=\"' + styleChild + ' width: 200%; height: 200%\"></div>' + '</div>';\n      element.appendChild(element.resizeSensor);\n      var computedStyle = window.getComputedStyle(element);\n      var position = computedStyle ? computedStyle.getPropertyValue('position') : null;\n\n      if ('absolute' !== position && 'relative' !== position && 'fixed' !== position) {\n        element.style.position = 'relative';\n      }\n\n      var expand = element.resizeSensor.childNodes[0];\n      var expandChild = expand.childNodes[0];\n      var shrink = element.resizeSensor.childNodes[1];\n      var dirty, rafId;\n      var size = getElementSize(element);\n      var lastWidth = size.width;\n      var lastHeight = size.height;\n      var initialHiddenCheck = true;\n      var lastAnimationFrame = 0;\n\n      var resetExpandShrink = function resetExpandShrink() {\n        var width = element.offsetWidth;\n        var height = element.offsetHeight;\n        expandChild.style.width = width + 10 + 'px';\n        expandChild.style.height = height + 10 + 'px';\n        expand.scrollLeft = width + 10;\n        expand.scrollTop = height + 10;\n        shrink.scrollLeft = width + 10;\n        shrink.scrollTop = height + 10;\n      };\n\n      var reset = function reset() {\n        // Check if element is hidden\n        if (initialHiddenCheck) {\n          var invisible = element.offsetWidth === 0 && element.offsetHeight === 0;\n\n          if (invisible) {\n            // Check in next frame\n            if (!lastAnimationFrame) {\n              lastAnimationFrame = requestAnimationFrame(function () {\n                lastAnimationFrame = 0;\n                reset();\n              });\n            }\n\n            return;\n          } else {\n            // Stop checking\n            initialHiddenCheck = false;\n          }\n        }\n\n        resetExpandShrink();\n      };\n\n      element.resizeSensor.resetSensor = reset;\n\n      var onResized = function onResized() {\n        rafId = 0;\n        if (!dirty) return;\n        lastWidth = size.width;\n        lastHeight = size.height;\n\n        if (element.resizedAttached) {\n          element.resizedAttached.call(size);\n        }\n      };\n\n      var onScroll = function onScroll() {\n        size = getElementSize(element);\n        dirty = size.width !== lastWidth || size.height !== lastHeight;\n\n        if (dirty && !rafId) {\n          rafId = requestAnimationFrame(onResized);\n        }\n\n        reset();\n      };\n\n      var addEvent = function addEvent(el, name, cb) {\n        if (el.attachEvent) {\n          el.attachEvent('on' + name, cb);\n        } else {\n          el.addEventListener(name, cb);\n        }\n      };\n\n      addEvent(expand, 'scroll', onScroll);\n      addEvent(shrink, 'scroll', onScroll); // Fix for custom Elements\n\n      requestAnimationFrame(reset);\n    }\n\n    forEachElement(element, function (elem) {\n      attachResizeEvent(elem, callback);\n    });\n\n    this.detach = function (ev) {\n      ResizeSensor.detach(element, ev);\n    };\n\n    this.reset = function () {\n      element.resizeSensor.resetSensor();\n    };\n  };\n\n  ResizeSensor.reset = function (element) {\n    forEachElement(element, function (elem) {\n      elem.resizeSensor.resetSensor();\n    });\n  };\n\n  ResizeSensor.detach = function (element, ev) {\n    forEachElement(element, function (elem) {\n      if (!elem) return;\n\n      if (elem.resizedAttached && typeof ev === \"function\") {\n        elem.resizedAttached.remove(ev);\n        if (elem.resizedAttached.length()) return;\n      }\n\n      if (elem.resizeSensor) {\n        if (elem.contains(elem.resizeSensor)) {\n          elem.removeChild(elem.resizeSensor);\n        }\n\n        delete elem.resizeSensor;\n        delete elem.resizedAttached;\n      }\n    });\n  };\n\n  if (typeof MutationObserver !== \"undefined\") {\n    var observer = new MutationObserver(function (mutations) {\n      for (var i in mutations) {\n        if (mutations.hasOwnProperty(i)) {\n          var items = mutations[i].addedNodes;\n\n          for (var j = 0; j < items.length; j++) {\n            if (items[j].resizeSensor) {\n              ResizeSensor.reset(items[j]);\n            }\n          }\n        }\n      }\n    });\n    document.addEventListener(\"DOMContentLoaded\", function (event) {\n      observer.observe(document.body, {\n        childList: true,\n        subtree: true\n      });\n    });\n  }\n\n  return ResizeSensor;\n});","map":null,"metadata":{},"sourceType":"script"}